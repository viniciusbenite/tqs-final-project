{"ast":null,"code":"import _toArray from\"/home/alina/Desktop/UA-3ANO/TQS/projeto_final/tqs-final-project/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toArray\";import _regeneratorRuntime from\"/home/alina/Desktop/UA-3ANO/TQS/projeto_final/tqs-final-project/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/alina/Desktop/UA-3ANO/TQS/projeto_final/tqs-final-project/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/alina/Desktop/UA-3ANO/TQS/projeto_final/tqs-final-project/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _assertThisInitialized from\"/home/alina/Desktop/UA-3ANO/TQS/projeto_final/tqs-final-project/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _createClass from\"/home/alina/Desktop/UA-3ANO/TQS/projeto_final/tqs-final-project/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/alina/Desktop/UA-3ANO/TQS/projeto_final/tqs-final-project/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/alina/Desktop/UA-3ANO/TQS/projeto_final/tqs-final-project/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import defaultBcg from'../images/cabeleireiro1.jpg';import Banner from'../components/Banner';import{Link}from'react-router-dom';import{CabeleireirosContext}from'../context';import StyledHero from'../components/StyledHero';import DatePicker from\"react-datepicker\";import\"react-datepicker/dist/react-datepicker.css\";import FormControlLabel from\"@material-ui/core/FormControlLabel\";import FormControl from\"@material-ui/core/FormControl\";import RadioGroup from\"@material-ui/core/RadioGroup\";import Radio from\"@material-ui/core/Radio\";import NavbarCliente from\"../components/NavbarCliente\";import NavbarDono from\"../components/NavbarDono\";import api from\"../services/api\";var SingleCabeleireiro=/*#__PURE__*/function(_Component){_inherits(SingleCabeleireiro,_Component);var _super=_createSuper(SingleCabeleireiro);_createClass(SingleCabeleireiro,[{key:\"componentDidMount\",value:function componentDidMount(){this.GetServices();}},{key:\"GetServices\",value:function GetServices(){var _this2=this;api.get(\"/service/\").then(function(res){_this2.setState({servicos:res.data});var names=[];var tempDic={};var data=res.data;for(var i in data){if(data[i].saloon.id==parseInt(_this2.props.match.params.slug)){tempDic[\"value\"]=data[i].name;tempDic[\"label\"]=data[i].name;names.push(tempDic);tempDic={};}}_this2.setState({servicosName:names});});}},{key:\"handleChangeService\",value:function handleChangeService(event){var _this3=this;this.setState({servico:event.target.value});var x=event.target.value;api.get(\"/schedule/\").then(function(rSch){var dataSch=rSch.data;var hor=[];var tempDic={};for(var n in dataSch){if(dataSch[n].service.saloon.id==parseInt(_this3.props.match.params.slug)){if(x==dataSch[n].service.name){_this3.setState({serv:dataSch[n].service.id});tempDic[\"value\"]=dataSch[n].startTime;tempDic[\"label\"]=dataSch[n].startTime;hor.push(tempDic);tempDic={};}}}_this3.setState({horarios:hor});});}}]);function SingleCabeleireiro(props){var _this;_classCallCheck(this,SingleCabeleireiro);_this=_super.call(this,props);_this.handleChangeDate=function(date){_this.setState({startDate:date});_this.setState({isActive:true});};_this.handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var _this$state,serv,hour,startDate,slug,dateFinal;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$state=_this.state,serv=_this$state.serv,hour=_this$state.hour,startDate=_this$state.startDate,slug=_this$state.slug;event.preventDefault();dateFinal=startDate.toString().split(\" \");dateFinal=dateFinal[2]+\" \"+dateFinal[1]+\" \"+dateFinal[3];_context.prev=4;console.log(serv);console.log(dateFinal);console.log(hour);console.log(slug);_context.next=11;return api.get(\"/user/\").then(function(response){var data=response.data;var res;for(var i in data){for(var n in data[i]){if(data[i].email===localStorage.getItem(\"user_email\")){res=data[i];}}}api.get(\"/service/\").then(function(resSer){var dataresSer=resSer.data;for(var _n in dataresSer){if(dataresSer[_n].id==parseInt(serv)){console.log(dataresSer[_n]);api.post(\"/reservation/\",{date:dateFinal,time:hour,users:res,services:dataresSer[_n]}).then();}}});});case 11:alert(\"Reserva efetuada com sucesso!\");_context.next=14;return api.get(\"/schedule/\").then(function(rHor){var datarHor=rHor.data;for(var n in datarHor){if(datarHor[n].startTime==hour){if(datarHor[n].service.id==parseInt(serv)){if(datarHor[n].service.id==parseInt(serv)){console.log(datarHor[n].id);}}}}});case 14:_this.props.history.push(\"/home\");_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](4);console.log(_context.t0);case 20:case\"end\":return _context.stop();}}},_callee,null,[[4,17]]);}));return function(_x){return _ref.apply(this,arguments);};}();_this.state={slug:parseInt(_this.props.match.params.slug),defaultBcg:defaultBcg,servico:\"\",hour:\"\",isActive:false,servicos:[],servicosName:[],horarios:[],serv:\"\"};_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));_this.handleChangeService=_this.handleChangeService.bind(_assertThisInitialized(_this));return _this;}_createClass(SingleCabeleireiro,[{key:\"render\",// componentDidMount() {}\nvalue:function render(){var _this4=this;var getCabeleireiro=this.context.getCabeleireiro;var cabeleireiro=getCabeleireiro(this.state.slug);if(!cabeleireiro){return/*#__PURE__*/React.createElement(\"div\",{className:\"error\"},/*#__PURE__*/React.createElement(\"h3\",null,\"Este cabeleireiro n\\xE3o existe\"),/*#__PURE__*/React.createElement(Link,{to:\"/cabeleireiros\",className:\"btn-primary\"},\"back to cabeleireiros\"));}var nome=cabeleireiro.nome,cidade=cabeleireiro.cidade,descricao=cabeleireiro.descricao,imagens=cabeleireiro.imagens,morada=cabeleireiro.morada,contacto=cabeleireiro.contacto;//this.setState({cabeleireiroName: nome});\nvar _imagens=_toArray(imagens),mainImg=_imagens[0],defaultImg=_imagens.slice(1);return/*#__PURE__*/React.createElement(React.Fragment,null,localStorage.getItem(\"user_type\")==\"dono\"?/*#__PURE__*/React.createElement(NavbarDono,null):/*#__PURE__*/React.createElement(NavbarCliente,null),/*#__PURE__*/React.createElement(StyledHero,{img:mainImg||this.state.defaultBcg},/*#__PURE__*/React.createElement(Banner,{title:\"\".concat(nome),subtitle:\"Fa\\xE7a j\\xE1 a sua marca\\xE7\\xE3o!\"},/*#__PURE__*/React.createElement(Link,{to:\"/cabeleireiros\",className:\"btn-primary\"},\"voltar\"))),/*#__PURE__*/React.createElement(\"section\",{className:\"single-cabeleireiro\"},/*#__PURE__*/React.createElement(\"div\",{className:\"single-cabeleireiro-info\"},/*#__PURE__*/React.createElement(\"article\",{className:\"desc\"},/*#__PURE__*/React.createElement(\"h3\",null,\"detalhes\"),/*#__PURE__*/React.createElement(\"p\",null,descricao),/*#__PURE__*/React.createElement(\"p\",null,\"Contacto Telef\\xF3nico: \",contacto),/*#__PURE__*/React.createElement(\"p\",null,morada),/*#__PURE__*/React.createElement(\"p\",null,cidade)),/*#__PURE__*/React.createElement(\"article\",{className:\"info\"}))),/*#__PURE__*/React.createElement(\"section\",{className:\"cabeleireiro-extras\"},/*#__PURE__*/React.createElement(\"h3\",null,\"Servi\\xE7os dispon\\xEDveis\")),/*#__PURE__*/React.createElement(\"div\",{className:\"service_option\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleSubmit},/*#__PURE__*/React.createElement(\"label\",null,\"Escolha o Servi\\xE7o:\",/*#__PURE__*/React.createElement(\"select\",{name:\"servico\",value:this.state.servico,onChange:this.handleChangeService},this.state.servicosName.map(function(e,key){return/*#__PURE__*/React.createElement(\"option\",{key:key,value:e.value},e.label);}))),/*#__PURE__*/React.createElement(\"label\",null,\"Escolha o Dia:\",/*#__PURE__*/React.createElement(DatePicker,{className:\"calendar\",selected:this.state.startDate,onChange:this.handleChangeDate,minDate:new Date(),withPortal:true})),/*#__PURE__*/React.createElement(\"div\",null,this.state.isActive?/*#__PURE__*/React.createElement(FormControl,{component:\"fieldset\"},/*#__PURE__*/React.createElement(\"label\",null,\"Escolha a Hora:\",/*#__PURE__*/React.createElement(RadioGroup,{\"aria-label\":\"time\",name:\"hour\",value:this.state.hour,onChange:function onChange(e){return _this4.setState({hour:e.target.value});}},this.state.horarios.map(function(e,key){return/*#__PURE__*/React.createElement(FormControlLabel,{key:key,value:e.value,control:/*#__PURE__*/React.createElement(Radio,null),label:e.label});})))):null),/*#__PURE__*/React.createElement(\"div\",{className:\"reservar\"},/*#__PURE__*/React.createElement(\"input\",{type:\"submit\",value:\"Marcar\"})))),/*#__PURE__*/React.createElement(\"section\",{className:\"cabeleireiro-extras\"}));}}]);return SingleCabeleireiro;}(Component);SingleCabeleireiro.contextType=CabeleireirosContext;export{SingleCabeleireiro as default};","map":{"version":3,"sources":["/home/alina/Desktop/UA-3ANO/TQS/projeto_final/tqs-final-project/frontend/src/pages/SingleCabeleireiro.js"],"names":["React","Component","defaultBcg","Banner","Link","CabeleireirosContext","StyledHero","DatePicker","FormControlLabel","FormControl","RadioGroup","Radio","NavbarCliente","NavbarDono","api","SingleCabeleireiro","GetServices","get","then","res","setState","servicos","data","names","tempDic","i","saloon","id","parseInt","props","match","params","slug","name","push","servicosName","event","servico","target","value","x","rSch","dataSch","hor","n","service","serv","startTime","horarios","handleChangeDate","date","startDate","isActive","handleSubmit","state","hour","preventDefault","dateFinal","toString","split","console","log","response","email","localStorage","getItem","resSer","dataresSer","post","time","users","services","alert","rHor","datarHor","history","bind","handleChangeService","getCabeleireiro","context","cabeleireiro","nome","cidade","descricao","imagens","morada","contacto","mainImg","defaultImg","map","e","key","label","Date","contextType"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport defaultBcg from '../images/cabeleireiro1.jpg';\nimport Banner from '../components/Banner';\nimport { Link } from 'react-router-dom';\nimport { CabeleireirosContext } from '../context';\nimport StyledHero from '../components/StyledHero';\nimport DatePicker from \"react-datepicker\";\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport RadioGroup from \"@material-ui/core/RadioGroup\";\nimport Radio from \"@material-ui/core/Radio\";\nimport NavbarCliente from \"../components/NavbarCliente\";\nimport NavbarDono from \"../components/NavbarDono\";\nimport api from \"../services/api\";\n\n\nexport default class SingleCabeleireiro extends Component {\n\n    componentDidMount() {\n        this.GetServices();\n    }\n\n    GetServices (){\n        api.get(\"/service/\").then(res => {\n            this.setState({\n                servicos: res.data,\n\n            })\n            let names =  [];\n            let tempDic = {};\n            let data = res.data;\n            for (const i in data){\n                if(data[i].saloon.id == parseInt(this.props.match.params.slug)){\n                    tempDic[\"value\"] = data[i].name;\n                    tempDic[\"label\"] = data[i].name;\n                    names.push(tempDic);\n                    tempDic = {};\n               }\n            }\n            this.setState({\n                servicosName: names,\n            })\n        });\n    }\n\n\n    handleChangeDate = date => {\n        this.setState({\n            startDate: date\n        });\n        this.setState({\n            isActive: true\n        })\n    };\n\n    handleChangeService(event) {\n        this.setState({servico: event.target.value});\n        let x = event.target.value;\n        api.get(\"/schedule/\").then(rSch =>{\n            let dataSch = rSch.data;\n            let hor =  [];\n            let tempDic = {};\n            for (const n in dataSch) {\n                if(dataSch[n].service.saloon.id == parseInt(this.props.match.params.slug)){\n                    if(x == dataSch[n].service.name){\n                        this.setState({\n                            serv: dataSch[n].service.id,\n                        })\n                        tempDic[\"value\"] = dataSch[n].startTime;\n                        tempDic[\"label\"] = dataSch[n].startTime;\n                        hor.push(tempDic);\n                        tempDic = {};\n                    }\n                }\n            }\n            this.setState({\n                horarios: hor,\n            })\n\n        })\n    }\n\n        handleSubmit = async event => {\n            const { serv, hour, startDate,slug } = this.state;\n            event.preventDefault();\n\n            let dateFinal = startDate.toString().split(\" \");\n            dateFinal = dateFinal[2] +\" \"+ dateFinal[1] +\" \"+ dateFinal[3];\n\n            try {\n                console.log(serv)\n                console.log(dateFinal)\n                console.log(hour);\n                console.log(slug);\n\n                await api.get(\"/user/\").then(function (response) {\n                    let data = response.data;\n                    let res;\n                    for (const i in data) {\n                        for (const n in data[i]) {\n                            if (data[i].email === localStorage.getItem(\"user_email\")) {\n                                res = data[i];\n                            }\n                        }\n                    }\n                    api.get(\"/service/\").then(resSer => {\n                        let dataresSer = resSer.data;\n                        for (const n in dataresSer) {\n                            if (dataresSer[n].id == parseInt(serv)) {\n                                console.log(dataresSer[n])\n                                api.post(\"/reservation/\", {\n                                    date: dateFinal,\n                                    time: hour,\n                                    users: res,\n                                    services: dataresSer[n]\n                                }).then();\n                            }\n                        }\n                    })\n                })\n\n\n                alert(\"Reserva efetuada com sucesso!\")\n                await api.get(\"/schedule/\",).then(rHor =>{\n                    let datarHor = rHor.data;\n                    for (const n in datarHor) {\n                        if(datarHor[n].startTime == hour){\n                            if(datarHor[n].service.id == parseInt(serv)){\n                                if(datarHor[n].service.id == parseInt(serv)){\n                                    console.log(datarHor[n].id)\n                                }\n                            }\n                        }\n                    }\n\n                })\n                this.props.history.push(\"/home\");\n\n              } catch (err) {\n                console.log(err);\n              }\n\n        }\n\n        constructor(props) {\n            super(props);\n        this.state = {\n            slug: parseInt(this.props.match.params.slug),\n            defaultBcg,\n            servico: \"\",\n            hour: \"\",\n            isActive: false,\n            servicos: [],\n            servicosName:[],\n            horarios: [],\n            serv:\"\",\n        };\n        this.handleSubmit = this.handleSubmit.bind(this);\n            this.handleChangeService = this.handleChangeService.bind(this);\n    }\n\n    static contextType = CabeleireirosContext;\n\n   // componentDidMount() {}\n    render() {\n        const { getCabeleireiro } = this.context;\n        const cabeleireiro = getCabeleireiro(this.state.slug);\n\n        if (!cabeleireiro) {\n            return <div className=\"error\">\n                <h3>Este cabeleireiro não existe</h3>\n                <Link to='/cabeleireiros' className=\"btn-primary\">back to cabeleireiros</Link>\n                </div>\n        }\n        const {nome, cidade, descricao, imagens,morada,contacto} = cabeleireiro;\n        //this.setState({cabeleireiroName: nome});\n        const [mainImg,...defaultImg] = imagens;\n        return(\n        <>\n        {localStorage.getItem(\"user_type\")==\"dono\" ? <NavbarDono></NavbarDono>:<NavbarCliente></NavbarCliente> }\n        <StyledHero img={mainImg ||\n          this.state.defaultBcg}>\n            <Banner title={`${nome}`} subtitle='Faça já a sua marcação!'>\n                <Link to=\"/cabeleireiros\" className=\"btn-primary\">\n                    voltar\n            </Link>\n            </Banner>\n        </StyledHero>\n\n            <section className=\"single-cabeleireiro\">\n                <div className=\"single-cabeleireiro-info\">\n                <article className=\"desc\">\n                <h3>detalhes</h3>\n                <p>{descricao}</p>\n                <p>Contacto Telefónico: {contacto}</p>\n                <p>{morada}</p>\n                <p>{cidade}</p>\n                </article>\n                    <article className=\"info\">\n                    </article>\n                </div>\n          </section>\n        <section className=\"cabeleireiro-extras\">\n        <h3>Serviços disponíveis</h3>\n\n        </section>\n        <div className=\"service_option\">\n            <form onSubmit={this.handleSubmit}>\n                <label>\n                    Escolha o Serviço:\n                    <select name=\"servico\" value={this.state.servico} onChange={this.handleChangeService}>\n                        {this.state.servicosName.map((e, key) => {\n                            return <option key={key} value={e.value}>{e.label}</option>;\n                        })}\n                    </select>\n                </label>\n                <label>\n                    Escolha o Dia:\n                    <DatePicker className=\"calendar\"\n                                selected={this.state.startDate}\n                                onChange={this.handleChangeDate}\n                                minDate={new Date()}\n                                withPortal\n\n                    />\n                </label>\n                <div>\n                    {this.state.isActive ?\n                        <FormControl component=\"fieldset\">\n                            <label>Escolha a Hora:\n                                <RadioGroup aria-label=\"time\" name=\"hour\" value={this.state.hour}\n                                            onChange={e => this.setState({ hour: e.target.value })}>\n                                    {this.state.horarios.map((e, key) => {\n                                        return <FormControlLabel key={key} value={e.value}  control={<Radio/>} label={e.label}/>;\n                                    })}\n                                </RadioGroup>\n                            </label>\n                        </FormControl>\n                        : null}\n                </div>\n                <div className=\"reservar\">\n                <input type=\"submit\" value=\"Marcar\" />\n                </div>\n            </form>\n        </div>\n        <section className=\"cabeleireiro-extras\">\n        </section>\n        </>\n      );\n    }\n}\n"]},"metadata":{},"sourceType":"module"}